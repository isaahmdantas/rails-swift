<script>
    function toastify(message, type) {
        var backgroundColor = type == 'success' || type == 'notice' ? '#4fbe87' : type == 'warning' ? '#ffc107' : type == 'info' ? '#0dcaf0' : type == 'error' ? "#f83f37" : "#6c757d";

        Toastify({
            text: message,
            duration: 3000,
            close: true,
            gravity: "bottom",
            position: "right",
            backgroundColor: backgroundColor,
            stopOnFocus: true,
            className: "rounded",
            onClick: function() {}
        }).showToast();
    }

    function flashMessages(type,msg){
        toastr.options.closeButton=true;
        toastr.options.preventDuplicates=true;
        toastr.options.escapeHtml=true;
        
        switch(type){
            case "alert":
                toastr.error(msg,"Erro!");
                break;
            case "error":
                toastr.error(msg,"Erro!");
                break;
            case "notice":
                toastr.success(msg,"Sucesso!");
                break;
            case "warning":
                toastr.warning(msg,"Alerta!");
                break;
            case "info":
                toastr.info(msg,"Informação!");
                break;
        }
    } 
    $(document).ready(function(){
        var flash=<%=flash.to_json.html_safe%>;
        $.each(flash,function(index,value){
            toastify(value[1], value[0]);
        })
    });
    $(document).ajaxComplete(function(event,request){
        var msg=decodeURIComponent(escape(request.getResponseHeader('X-Message')));
        var type=request.getResponseHeader('X-Message-Type');
        toastify(msg, type);
    });
</script>